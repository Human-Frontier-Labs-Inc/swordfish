# Swordphish

**AI-Powered Email Security Platform**

---

## What It Is

Swordphish is an email security platform that protects organizations from phishing, Business Email Compromise (BEC), malware, and advanced email threats. It uses a multi-layer detection pipeline combining deterministic analysis, machine learning, and LLM-powered threat interpretation.

---

## Core Capabilities

### Email Protection Channels

| Channel | Integration Method | Description |
|---------|-------------------|-------------|
| Microsoft 365 | Graph API + Webhooks | Real-time threat detection, quarantine, banner injection |
| Google Workspace | Gmail API + Pub/Sub | Push-based email processing, label-based quarantine |
| SMTP Gateway | Inline MTA (Go) | On-premises/hybrid mail flow inspection, DKIM signing |

### Detection Pipeline

**Layer 1: Deterministic Analysis** (runs on 100% of emails)
- SPF/DKIM/DMARC authentication verification
- Header anomaly detection
- Display name spoofing detection
- Domain reputation (age, homoglyphs, cousin domains)
- URL lexical analysis
- Attachment static analysis (file type, macros, executables)
- QR-code phishing detection

**Layer 2: Machine Learning** (runs on ~30% of emails, risk-gated)
- Phishing/BEC classification models
- Sender anomaly detection
- Thread context analysis
- Grammar and formatting anomalies

**Layer 3: LLM Analysis** (runs on ~5% of emails, confidence-gated)
- Claude 3.5 Haiku for context-aware threat interpretation
- BEC pattern detection
- Human-readable explanation generation
- Intent analysis

**Layer 4: Threat Intelligence** (real-time lookups)
- PhishTank, URLhaus, OpenPhish feeds
- Domain age and WHOIS data
- IP reputation databases

**Layer 5: Sandbox Analysis** (async, ~2% of emails)
- Attachment detonation in isolated VMs
- Behavioral analysis
- Network activity monitoring
- IOC extraction

### BEC Detection Module

Dedicated engine for Business Email Compromise attacks:

- Executive impersonation (display name + domain spoofing)
- Wire transfer and invoice fraud patterns
- Gift card scam detection
- Payroll diversion attempts
- VIP list protection with behavioral baselines
- Urgency + secrecy + financial request combination detection

### Explainability

Every quarantined email includes a plain-English explanation:

```
This email was quarantined because:
1. The sender's domain (acme-invoices.com) was registered 3 days ago
2. The display name "John Smith - CFO" matches your executive list
3. The message requests an urgent wire transfer
4. Pattern consistent with Business Email Compromise
```

Explanations are generated by Claude AI based on detection signals.

---

## Architecture

### Technology Stack

| Component | Technology |
|-----------|------------|
| Frontend | Next.js 16, React 19, TypeScript |
| Auth | Clerk (multi-tenant, OAuth, SSO) |
| Database | Neon PostgreSQL (serverless) |
| Cache | Upstash Redis |
| Queue | Upstash Kafka |
| Edge | Cloudflare Workers |
| Compute | Kubernetes (Hetzner k3s) |
| AI | Claude 3.5 Haiku (Anthropic) |
| Storage | Cloudflare R2 |

### Infrastructure Cost

< $1 per user per month at scale

### Design Principles

1. **Deterministic-first**: Rule-based checks run before expensive ML/LLM
2. **Gated escalation**: LLM only invoked when ML confidence is 0.4-0.7
3. **Tenant isolation**: Complete data separation between organizations
4. **Async sandbox**: Detonation doesn't block mail delivery
5. **Verdict caching**: Reduces redundant analysis

---

## Multi-Tenant / MSP Architecture

Built for Managed Service Providers from the ground up:

| Feature | Description |
|---------|-------------|
| Tenant switching | Instant context switch (Cmd+K) |
| Bulk operations | Apply policies across multiple tenants |
| Policy templates | Create once, deploy to many |
| White-label reports | MSP-branded PDF exports |
| Per-tenant billing | Usage tracking for accurate invoicing |
| Global search | Find threats across all managed tenants |
| RBAC | msp_admin, tenant_admin, analyst, viewer roles |

---

## Admin Dashboard

### For Direct Customers

- **Threat Inbox**: Quarantined emails with verdicts and explanations
- **Dashboard**: Real-time metrics (threats blocked, emails scanned, detection rate)
- **Quarantine Management**: Review, release, delete
- **Policy Management**: Allow/blocklist, custom rules
- **Integrations**: Connection status for O365/Gmail
- **Reports**: Weekly summaries, executive-friendly PDFs
- **Audit Logs**: Complete audit trail

### For MSP Admins

- Multi-tenant overview dashboard
- Threat management across all clients
- Aggregated analytics and reporting
- Tenant health monitoring

---

## Onboarding

| Customer Type | Target Time |
|---------------|-------------|
| Direct (O365/Gmail) | < 10 minutes |
| MSP tenant provisioning | < 5 minutes |
| SMTP gateway | < 30 minutes |

Self-service flowâ€”no mandatory sales calls.

---

## Pricing Structure

| Plan | Monthly | Users | Emails/Month |
|------|---------|-------|--------------|
| Starter | $99 | Up to 25 | 10,000 |
| Pro | $499 | Up to 250 | 100,000 |
| Enterprise | $1,999+ | Unlimited | Unlimited |

**Overages:**
- Starter: $0.001/email, $2/additional user
- Pro: $0.0005/email, $1.50/additional user

---

## Current Status

- **Product stage**: Production-ready
- **Integrations**: Microsoft 365, Google Workspace, SMTP Gateway
- **Compliance**: SOC 2 preparation in progress
- **Testing**: Comprehensive E2E test suite (12+ test suites)

### Recent Development

- MSP admin reports and analytics dashboard
- MSP threat management dashboard
- Enhanced BEC detection with VIP protection
- Comprehensive audit logging
- Email sync improvements

---

## Performance Targets

| Metric | Target |
|--------|--------|
| False positive rate | < 0.5% |
| Remediation latency | < 60 seconds |
| Detection speed (non-sandbox) | < 1 second |
| Availability | 99.9% uptime |

---

## Technical Specifications

### API Scopes Required

**Microsoft 365:**
- Mail.Read, Mail.ReadWrite
- User.Read.All
- MailboxSettings.Read

**Google Workspace:**
- gmail.readonly, gmail.modify
- Domain-wide delegation

### Data Handling

- Email bodies deleted after analysis (no long-term retention)
- Metadata retained for audit/reporting
- Encrypted at rest and in transit
- Tenant-isolated storage

### Rate Limits

Tiered by plan to prevent abuse:
- Starter: 100 LLM calls/day
- Pro: 500 LLM calls/day
- Enterprise: Custom

---

## Contact

**[Your Name]**
Founder, Swordphish
[Email]
[Phone]
