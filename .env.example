# ============================================================================
# SWORDFISH - Environment Variables Configuration
# ============================================================================
# Copy this file to .env.local and fill in your values
# NEVER commit .env.local to version control
# ============================================================================

# ----------------------------------------------------------------------------
# APPLICATION
# ----------------------------------------------------------------------------
NODE_ENV=development
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_APP_NAME=Swordfish

# ----------------------------------------------------------------------------
# CLERK AUTHENTICATION
# https://dashboard.clerk.com - Create app, copy keys from quickstart
# ----------------------------------------------------------------------------
CLERK_SECRET_KEY=sk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Clerk routing
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_SIGN_IN_FORCE_REDIRECT_URL=/dashboard
NEXT_PUBLIC_CLERK_SIGN_UP_FORCE_REDIRECT_URL=/dashboard

# Clerk webhooks (for user/org sync)
CLERK_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ----------------------------------------------------------------------------
# DATABASE - NEON (PostgreSQL)
# https://console.neon.tech - Create project, copy connection string
# ----------------------------------------------------------------------------
DATABASE_URL=postgresql://user:password@ep-xxxxx.region.aws.neon.tech/swordfish?sslmode=require

# Connection pooling (for serverless)
DATABASE_URL_UNPOOLED=postgresql://user:password@ep-xxxxx.region.aws.neon.tech/swordfish?sslmode=require

# ----------------------------------------------------------------------------
# CACHE - UPSTASH REDIS
# https://console.upstash.com - Create Redis database
# ----------------------------------------------------------------------------
UPSTASH_REDIS_REST_URL=https://xxxxx.upstash.io
UPSTASH_REDIS_REST_TOKEN=AXxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# Queue name for Gmail ingestion jobs
UPSTASH_QUEUE_NAME=gmail-ingest

# Gmail queue worker tuning (optional)
GMAIL_QUEUE_MAX_ATTEMPTS=5
GMAIL_QUEUE_TIME_BUDGET_MS=45000
GMAIL_QUEUE_MAX_MESSAGES=20

# ----------------------------------------------------------------------------
# QUEUE - UPSTASH KAFKA
# https://console.upstash.com - Create Kafka cluster
# ----------------------------------------------------------------------------
UPSTASH_KAFKA_REST_URL=https://xxxxx.upstash.io
UPSTASH_KAFKA_REST_USERNAME=xxxxx
UPSTASH_KAFKA_REST_PASSWORD=xxxxx

# ----------------------------------------------------------------------------
# STORAGE - CLOUDFLARE R2
# https://dash.cloudflare.com - R2 > Create bucket
# ----------------------------------------------------------------------------
CLOUDFLARE_ACCOUNT_ID=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CLOUDFLARE_R2_ACCESS_KEY_ID=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CLOUDFLARE_R2_SECRET_ACCESS_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CLOUDFLARE_R2_BUCKET_NAME=swordfish-artifacts
CLOUDFLARE_R2_ENDPOINT=https://xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.r2.cloudflarestorage.com

# ----------------------------------------------------------------------------
# CLOUDFLARE WORKERS (URL Rewriting)
# https://dash.cloudflare.com - Workers & Pages
# ----------------------------------------------------------------------------
CLOUDFLARE_API_TOKEN=xxxxx
CLOUDFLARE_ZONE_ID=xxxxx
NEXT_PUBLIC_REWRITE_DOMAIN=click.swordfish.io

# ----------------------------------------------------------------------------
# MICROSOFT 365 INTEGRATION
# https://portal.azure.com - App registrations > New registration
# Required scopes: Mail.Read, Mail.ReadWrite, Mail.Send, User.Read.All
# ----------------------------------------------------------------------------
MICROSOFT_CLIENT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
MICROSOFT_CLIENT_SECRET=xxxxx~xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
MICROSOFT_TENANT_ID=common
MICROSOFT_REDIRECT_URI=http://localhost:3000/api/integrations/o365/callback

# ----------------------------------------------------------------------------
# GOOGLE WORKSPACE INTEGRATION
# https://console.cloud.google.com - APIs & Services > Credentials
# Enable: Gmail API, Cloud Pub/Sub API
# Required scopes: gmail.modify, gmail.readonly
# ----------------------------------------------------------------------------
GOOGLE_CLIENT_ID=xxxxx.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-xxxxxxxxxxxxxxxxxxxxxxxxx
GOOGLE_REDIRECT_URI=http://localhost:3000/api/integrations/gmail/callback

# Google Pub/Sub (for Gmail push notifications)
GOOGLE_PUBSUB_PROJECT_ID=your-project-id
GOOGLE_PUBSUB_TOPIC=gmail-notifications
GOOGLE_PUBSUB_SUBSCRIPTION=gmail-notifications-sub

# Service account for domain-wide delegation (optional, for Workspace admins)
GOOGLE_SERVICE_ACCOUNT_EMAIL=swordfish@your-project.iam.gserviceaccount.com
GOOGLE_SERVICE_ACCOUNT_KEY=base64_encoded_service_account_json

# ----------------------------------------------------------------------------
# NANGO - OAuth Token Management
# https://app.nango.dev - Handles OAuth flows, token storage, and refresh
# Replaces direct OAuth credential storage for security
# ----------------------------------------------------------------------------
NANGO_SECRET_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ----------------------------------------------------------------------------
# LLM - ANTHROPIC (Claude)
# https://console.anthropic.com - API Keys
# Used for: Intent analysis, explanation generation
# ----------------------------------------------------------------------------
ANTHROPIC_API_KEY=sk-ant-api03-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# LLM configuration
LLM_MODEL=claude-3-5-sonnet-20241022
LLM_MAX_TOKENS=1024
LLM_DAILY_LIMIT_PER_TENANT=100

# ----------------------------------------------------------------------------
# SANDBOX - JOE SANDBOX (V1)
# https://www.joesecurity.org - API access
# ----------------------------------------------------------------------------
JOE_SANDBOX_API_KEY=xxxxx
JOE_SANDBOX_API_URL=https://jbxcloud.joesecurity.org/api
JOE_SANDBOX_ANALYSIS_TIMEOUT=180

# ----------------------------------------------------------------------------
# REPUTATION APIS
# ----------------------------------------------------------------------------

# AbuseIPDB - IP Reputation
# https://www.abuseipdb.com/account/api
ABUSEIPDB_API_KEY=xxxxx

# URLScan.io - URL Scanning
# https://urlscan.io/user/profile
URLSCAN_API_KEY=xxxxx

# VirusTotal - File Hash Reputation
# https://www.virustotal.com/gui/my-apikey
VIRUSTOTAL_API_KEY=xxxxx

# Whoisology - Domain Age/Reputation (optional)
# https://whoisology.com/account
WHOISOLOGY_API_KEY=xxxxx

# ----------------------------------------------------------------------------
# ML MODELS (Optional - V2)
# Cloudflare Workers AI or self-hosted
# ----------------------------------------------------------------------------
# CLOUDFLARE_AI_GATEWAY_URL=
# ML_MODEL_ENDPOINT=

# ----------------------------------------------------------------------------
# SMTP GATEWAY (Optional - for inline SMTP mode)
# ----------------------------------------------------------------------------
SMTP_GATEWAY_PORT=25
SMTP_GATEWAY_TLS_PORT=587
SMTP_GATEWAY_HOSTNAME=mx.swordfish.io

# DKIM signing
DKIM_SELECTOR=swordfish
DKIM_PRIVATE_KEY=base64_encoded_private_key

# ----------------------------------------------------------------------------
# ENCRYPTION
# Generate with: openssl rand -base64 32
# ----------------------------------------------------------------------------
ENCRYPTION_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Per-tenant key derivation salt
ENCRYPTION_SALT=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ----------------------------------------------------------------------------
# MONITORING & OBSERVABILITY (Optional)
# ----------------------------------------------------------------------------
# Datadog
# DATADOG_API_KEY=
# DATADOG_APP_KEY=

# Sentry
# SENTRY_DSN=
# NEXT_PUBLIC_SENTRY_DSN=

# ----------------------------------------------------------------------------
# BILLING (Optional - for production)
# Stripe for subscription management
# ----------------------------------------------------------------------------
# STRIPE_SECRET_KEY=
# STRIPE_PUBLISHABLE_KEY=
# STRIPE_WEBHOOK_SECRET=

# ----------------------------------------------------------------------------
# DEVELOPMENT/TESTING
# ----------------------------------------------------------------------------
# Skip external API calls in development
MOCK_EXTERNAL_APIS=false

# Test tenant for development
TEST_TENANT_ID=test_tenant_dev
TEST_USER_EMAIL=dev@example.com
